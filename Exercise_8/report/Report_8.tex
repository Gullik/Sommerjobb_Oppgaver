% arara: pdflatex
% !arara: biber
% !arara: pdflatex
% How to run: 
% 1) pdflatex "filename".tex
% 2) biber "filename"
% 3) pdflatex "filename".tex
% 4) pdflatex "filename".tex


\documentclass[x11names]{article}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{color}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[T1]{fontenc}
\usepackage{shadow}
\usepackage{hyperref}
\usepackage{physics}
\usepackage{url}
%For use in pictures
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{wrapfig}

\usepackage[l2tabu]{nag} %NAgs when using bad practices


\usepackage{subcaption}
\usepackage[utf8]{inputenc}
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage[font={small,it}]{caption}
\usepackage[margin=0.7in]{geometry} %Sets the margins in the document
\usepackage{siunitx}    %Allows use of SI units macros

%Defines calculator way to write powers of ten
\sisetup{output-exponent-marker=\textsc{e}}


% Change numbering and some commands
\renewcommand\thesection{Exercise \Roman{section}}
\renewcommand\thesubsection{\Roman{section}.\alph{subsection}}

%% references
\usepackage[style=authoryear,
            bibstyle=authoryear,
            backend=biber,
            % refsection=chapter,
            maxbibnames=99,
            maxnames=2,
            firstinits=true,
            uniquename=init,
            natbib=true,
            dashed=false]{biblatex}

\addbibresource{bibliography.bib}

\usepackage[capitalize]{cleveref}

\setcounter{tocdepth}{2}

\lstset{language=c++}
\lstset{alsolanguage=[90]Fortran}
\lstset{basicstyle=\small}
\lstset{backgroundcolor=\color{white}}
\lstset{frame=single}
\lstset{stringstyle=\ttfamily}
\lstset{keywordstyle=\color{red}\bfseries}
\lstset{commentstyle=\itshape\color{blue}}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{showtabs=false}
\lstset{breaklines}


\definecolor{keywords}{RGB}{255,0,90}
      \definecolor{comments}{RGB}{0,0,113}
      \definecolor{red}{RGB}{160,0,0}
      \definecolor{green}{RGB}{0,150,0}
       
      \lstset{language=Python, 
              basicstyle=\ttfamily\small, 
              keywordstyle=\color{keywords},
              commentstyle=\color{comments},
              stringstyle=\color{red},
              showstringspaces=false,
              identifierstyle=\color{green}
              }



\title{ Exercise 8 \\ Sommerjobb Numeriske Plasmaoppgaver }
\author{Gullik Vetvik Killie
		}

\renewcommand{\va}{\vec}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Actual text starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}


\maketitle

\section{}

\subsection{Theory}
  In a warm, magnetized plasma there are a type of wave called electrostatic ion waves which have the following dispersion relation.

  \begin{align}
    \begin{split}
      \epsilon(\omega,k) = &1- \frac{k^2c_s^2}{\omega^2} 
      \\
      & + \frac{\Omega_{ci}}{\omega}\tan^2\theta \left[  \frac{1}{ \frac{\omega}{\Omega_{ce}}\tan^2 \theta - \frac{\Omega_{ce}}{\omega} \left( 1 - \frac{\omega^2}{\Omega_{ce}} \right) }  
                                                        -\frac{1}{ \frac{\omega}{\Omega_{ci}}\tan^2 \theta - \frac{\Omega_{ci}}{\omega} \left( 1 - \frac{\omega^2}{\Omega_{ci}} \right) } \right]
    \end{split}
  \end{align}

\subsection{Results}
  To make sure that the root finding algorithm works correctly 


\appendix
\section{Comments to Exercise}
  
  \begin{itemize}
    \item Typo in dispersion relation, second term: \(\frac{k^2c_s^s}{\omega^2}\) should be \(\frac{k^2c_s^2}{\omega^2}\). (The \(c_s\) is raised to the power s instead of 2)
    \item Would it be an idea to start with a simple dispersion relation, implement the root finding algorithm on that, and then put in the complicated dispersion relation. An easy dispersion relation would be the one for electron oscillations in an unmagnetized plasma.
    \begin{align}
      \epsilon(\omega, k) &= 1 + \frac{5}{3} - \frac{\omega}{\omega_{pe}}
    \end{align}
  \end{itemize}



\section{Code}
  \label{sec:code}
  \lstinputlisting{../source/dispersion.py}


\end{document}